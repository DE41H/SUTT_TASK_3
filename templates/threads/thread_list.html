<!-- threads/thread_list.html -->
{% extends 'threads/base.html' %}
{% block title %}{{ category.name }} - Threads{% endblock %}
{% block content %}
<div x-data="{ search: '{{ query|default:'' }}' }" class="space-y-8">
    <!-- Header -->
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
            <h1 class="text-3xl font-bold text-gray-900">{{ category.name }}</h1>
            <p class="text-gray-500 mt-1">{{ threads.paginator.count }} threads</p>
        </div>
        <div class="flex flex-col sm:flex-row gap-3">
            <div class="relative">
                <input type="text" 
                       x-model="search"
                       placeholder="Search threads..." 
                       class="w-full sm:w-80 pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent shadow-sm">
                <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
            </div>
            <a href="{% url 'threads:thread_create' category.pk %}" 
               class="px-8 py-3 bg-gradient-to-r from-primary to-primary-dark hover:from-primary-dark hover:to-primary text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-200 whitespace-nowrap">
                <i class="fas fa-plus mr-2"></i>New Thread
            </a>
        </div>
    </div>

    <!-- Filters -->
    <div class="flex flex-wrap gap-2 bg-white/50 backdrop-blur-xl rounded-xl p-4 border border-gray-200/50">
        <a href="?orderby=-created_at" class="{% if orderby == '-created_at' %}bg-primary text-white shadow-lg{% else %}bg-gray-100 hover:bg-gray-200{% endif %} px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200">
            <i class="fas fa-clock mr-1"></i>Newest
        </a>
        <a href="?orderby=-upvote_count" class="{% if orderby == '-upvote_count' %}bg-accent text-white shadow-lg{% else %}bg-gray-100 hover:bg-gray-200{% endif %} px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200">
            <i class="fas fa-fire mr-1"></i>Popular
        </a>
    </div>

    <!-- Threads -->
    {% if threads %}
    <div class="grid gap-4">
        {% for thread in threads %}
        <div class="group bg-white/70 backdrop-blur-xl rounded-2xl border border-gray-200/50 hover:border-gray-300/50 hover:shadow-xl transition-all duration-300 p-8 hover:-translate-y-1">
            <div class="flex flex-col lg:flex-row lg:items-start gap-6">
                <div class="flex-shrink-0">
                    <div class="w-12 h-12 bg-gradient-to-r from-primary to-primary-dark rounded-xl flex items-center justify-center text-white font-semibold">
                        {{ thread.author.username.0|upper }}
                    </div>
                </div>
                <div class="flex-1 min-w-0">
                    <div class="flex items-start justify-between mb-3">
                        <h3 class="text-xl font-bold text-gray-900 group-hover:text-primary transition-colors line-clamp-2">
                            {{ thread.title }}
                        </h3>
                        <div class="flex items-center space-x-4 ml-4">
                            <span class="flex items-center text-sm text-gray-500">
                                <i class="fas fa-reply mr-1"></i>{{ thread.reply_count }}
                            </span>
                            <span class="flex items-center text-sm text-gray-500">
                                <i class="fas fa-thumbs-up mr-1"></i>{{ thread.upvote_count }}
                            </span>
                        </div>
                    </div>
                    <p class="text-gray-600 mb-4 line-clamp-2">{{ thread.content|truncatewords:20 }}</p>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center text-sm text-gray-500 space-x-4">
                            <span>{{ thread.author.username }}</span>
                            <span>â€¢</span>
                            <span>{{ thread.created_at|timesince }} ago</span>
                            {% if thread.islocked %}<i class="fas fa-lock text-yellow-500 ml-2"></i>{% endif %}
                        </div>
                        <a href="{% url 'threads:thread_detail' thread.pk orderby=orderby %}" 
                           class="inline-flex items-center px-6 py-2 bg-gradient-to-r from-gray-100 to-gray-200 hover:from-gray-200 hover:to-gray-300 text-gray-700 font-medium rounded-xl shadow-sm hover:shadow-md transition-all duration-200">
                            <i class="fas fa-arrow-right mr-2"></i>Read
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if threads.has_other_pages %}
    <div class="flex items-center justify-center space-x-2 mt-12">
        {% if threads.has_previous %}
            <a href="?page=1{% if query %}&q={{ query }}{% endif %}{% if orderby %}&orderby={{ orderby }}{% endif %}" 
               class="px-4 py-2 bg-white border border-gray-200 rounded-xl hover:shadow-md transition-all">
                <i class="fas fa-angle-double-left"></i>
            </a>
            <a href="?page={{ threads.previous_page_number }}{% if query %}&q={{ query }}{% endif %}{% if orderby %}&orderby={{ orderby }}{% endif %}" 
               class="w-12 h-12 flex items-center justify-center bg-white border border-gray-200 rounded-xl hover:shadow-md transition-all">
                <i class="fas fa-angle-left"></i>
            </a>
        {% endif %}
        
        {% for num in threads.paginator.page_range %}
            {% if threads.number == num %}
                <span class="w-12 h-12 flex items-center justify-center bg-primary text-white font-semibold rounded-xl shadow-lg">{{ num }}</span>
            {% elif num > threads.number|add:'-3' and num < threads.number|add:'3' %}
                <a href="?page={{ num }}{% if query %}&q={{ query }}{% endif %}{% if orderby %}&orderby={{ orderby }}{% endif %}" 
                   class="w-12 h-12 flex items-center justify-center bg-white border border-gray-200 rounded-xl hover:shadow-md transition-all">{{ num }}</a>
            {% endif %}
        {% endfor %}
        
        {% if threads.has_next %}
            <a href="?page={{ threads.next_page_number }}{% if query %}&q={{ query }}{% endif %}{% if orderby %}&orderby={{ orderby }}{% endif %}" 
               class="w-12 h-12 flex items-center justify-center bg-white border border-gray-200 rounded-xl hover:shadow-md transition-all">
                <i class="fas fa-angle-right"></i>
            </a>
            <a href="?page={{ threads.paginator.num_pages }}{% if query %}&q={{ query }}{% endif %}{% if orderby %}&orderby={{ orderby }}{% endif %}" 
               class="px-4 py-2 bg-white border border-gray-200 rounded-xl hover:shadow-md transition-all">
                <i class="fas fa-angle-double-right"></i>
            </a>
        {% endif %}
    </div>
    {% endif %}
    {% else %}
    <div class="text-center py-20">
        <i class="fas fa-inbox text-6xl text-gray-300 mb-6"></i>
        <h3 class="text-2xl font-bold text-gray-900 mb-2">No threads yet</h3>
        <p class="text-gray-500 mb-8 max-w-md mx-auto">Be the first to start a conversation in this category.</p>
        <a href="{% url 'threads:thread_create' category.pk %}" 
           class="inline-flex items-center px-8 py-4 bg-gradient-to-r from-primary to-primary-dark hover:from-primary-dark hover:to-primary text-white font-semibold rounded-2xl shadow-xl hover:shadow-2xl transform hover:-translate-y-1 transition-all duration-300">
            <i class="fas fa-plus mr-3 text-lg"></i>
            Create First Thread
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
{% block extra_js %}
<script>
    // Auto-search functionality
    document.addEventListener('DOMContentLoaded', function() {
        const searchInput = document.querySelector('input[type="text"]');
        if (searchInput) {
            let timeout;
            searchInput.addEventListener('input', function() {
                clearTimeout(timeout);
                timeout = setTimeout(() => {
                    const params = new URLSearchParams(window.location.search);
                    params.set('q', this.value);
                    window.location.search = params.toString();
                }, 500);
            });
        }
    });
</script>
{% endblock %}[file:1][file:4]
